"use client"

import type React from "react"
import { useState, useCallback, useEffect } from "react"
import { Card } from "@/components/ui/card"
import { Button } from "@/components/ui/button"
import { Progress } from "@/components/ui/progress"
import {
  Coins,
  Star,
  Home,
  Package,
  Calendar,
  Wallet,
  Zap,
  User,
  Gift,
  Trophy,
  Sparkles,
  Target,
  Clock,
  TrendingUp,
} from "lucide-react"

interface GameState {
  magnumCoins: number
  stars: number
  energy: number
  maxEnergy: number
  clickAnimating: boolean
  energyAnimating: boolean
  rewardPopups: Array<{ id: number; x: number; y: number }>
  totalClicks: number
  lastEnergyRestore: number
  level: number
}

interface CaseItem {
  id: string
  name: string
  price: number
  rarity: "common" | "rare" | "epic" | "legendary" | "mythic"
  rewards: Array<{ type: "coins" | "stars" | "energy"; min: number; max: number }>
  image: string
  glowColor: string
}

export default function TelegramClickerApp() {
  const [gameState, setGameState] = useState<GameState>({
    magnumCoins: 0,
    stars: 0,
    energy: 100,
    maxEnergy: 100,
    clickAnimating: false,
    energyAnimating: false,
    rewardPopups: [],
    totalClicks: 0,
    lastEnergyRestore: Date.now(),
    level: 1,
  })

  const [activeTab, setActiveTab] = useState("home")
  const [selectedCase, setSelectedCase] = useState<CaseItem | null>(null)
  const [openingCase, setOpeningCase] = useState(false)
  const [caseResult, setCaseResult] = useState<any>(null)
  const [loading, setLoading] = useState(true)
  const [telegramId, setTelegramId] = useState<number | null>(null)

  // Get Telegram user ID from web app data
  useEffect(() => {
    if (typeof window !== 'undefined' && window.Telegram?.WebApp) {
      const tg = window.Telegram.WebApp
      const userId = tg.initDataUnsafe?.user?.id
      if (userId) {
        setTelegramId(userId)
        loadUserData(userId)
      }
    } else {
      // For development/testing
      setTelegramId(12345)
      loadUserData(12345)
    }
  }, [])

  const loadUserData = async (userId: number) => {
    try {
      const response = await fetch(`/api/users?telegramId=${userId}`)
      const data = await response.json()
      
      if (data.success) {
        setGameState(prev => ({
          ...prev,
          magnumCoins: data.user.magnumCoins,
          stars: data.user.stars,
          energy: data.user.energy,
          maxEnergy: data.user.maxEnergy,
          totalClicks: data.user.totalClicks,
          level: data.user.level,
          lastEnergyRestore: new Date(data.user.lastEnergyRestore).getTime()
        }))
      }
    } catch (error) {
      console.error('Error loading user data:', error)
    } finally {
      setLoading(false)
    }
  }

  useEffect(() => {
    const interval = setInterval(() => {
      setGameState((prev) => {
        const now = Date.now()
        const timeDiff = now - prev.lastEnergyRestore
        const energyToRestore = Math.floor(timeDiff / 30000) // 1 energy per 30 seconds

        if (energyToRestore > 0 && prev.energy < prev.maxEnergy) {
          return {
            ...prev,
            energy: Math.min(prev.maxEnergy, prev.energy + energyToRestore),
            lastEnergyRestore: now,
          }
        }
        return prev
      })
    }, 1000)

    return () => clearInterval(interval)
  }, [])

  const cases: CaseItem[] = [
    {
      id: "bronze",
      name: "–ë—Ä–æ–Ω–∑–æ–≤—ã–π –∫–µ–π—Å",
      price: 100,
      rarity: "common",
      rewards: [
        { type: "coins", min: 50, max: 200 },
        { type: "stars", min: 0.001, max: 0.01 },
      ],
      image: "ü•â",
      glowColor: "rgba(205, 127, 50, 0.5)",
    },
    {
      id: "silver",
      name: "–°–µ—Ä–µ–±—Ä—è–Ω—ã–π –∫–µ–π—Å",
      price: 500,
      rarity: "rare",
      rewards: [
        { type: "coins", min: 300, max: 800 },
        { type: "stars", min: 0.01, max: 0.05 },
        { type: "energy", min: 10, max: 30 },
      ],
      image: "ü•à",
      glowColor: "rgba(192, 192, 192, 0.5)",
    },
    {
      id: "gold",
      name: "–ó–æ–ª–æ—Ç–æ–π –∫–µ–π—Å",
      price: 1000,
      rarity: "epic",
      rewards: [
        { type: "coins", min: 800, max: 2000 },
        { type: "stars", min: 0.05, max: 0.15 },
        { type: "energy", min: 20, max: 50 },
      ],
      image: "ü•á",
      glowColor: "rgba(255, 215, 0, 0.5)",
    },
    {
      id: "platinum",
      name: "–ü–ª–∞—Ç–∏–Ω–æ–≤—ã–π –∫–µ–π—Å",
      price: 5000,
      rarity: "legendary",
      rewards: [
        { type: "coins", min: 3000, max: 8000 },
        { type: "stars", min: 0.1, max: 0.5 },
        { type: "energy", min: 50, max: 100 },
      ],
      image: "üíé",
      glowColor: "rgba(147, 51, 234, 0.5)",
    },
    {
      id: "mythic",
      name: "–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π –∫–µ–π—Å",
      price: 15000,
      rarity: "mythic",
      rewards: [
        { type: "coins", min: 10000, max: 25000 },
        { type: "stars", min: 0.5, max: 2.0 },
        { type: "energy", min: 100, max: 200 },
      ],
      image: "üëë",
      glowColor: "rgba(255, 20, 147, 0.5)",
    },
  ]

  const handleClick = useCallback(
    async (event: React.MouseEvent<HTMLButtonElement>) => {
      if (gameState.energy <= 0 || !telegramId) return

      const rect = event.currentTarget.getBoundingClientRect()
      const x = event.clientX - rect.left
      const y = event.clientY - rect.top

      try {
        const response = await fetch('/api/click', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ telegramId }),
        })

        const data = await response.json()

        if (data.success) {
          setGameState((prev) => ({
            ...prev,
            magnumCoins: data.user.magnumCoins,
            stars: data.user.stars,
            energy: data.user.energy,
            totalClicks: data.user.totalClicks,
            level: data.user.level,
            clickAnimating: true,
            energyAnimating: true,
            rewardPopups: [...prev.rewardPopups, { id: Date.now(), x, y }],
          }))

          setTimeout(() => {
            setGameState((prev) => ({ ...prev, clickAnimating: false, energyAnimating: false }))
          }, 800)

          setTimeout(() => {
            setGameState((prev) => ({
              ...prev,
              rewardPopups: prev.rewardPopups.filter((popup) => popup.id !== Date.now()),
            }))
          }, 1200)
        }
      } catch (error) {
        console.error('Error processing click:', error)
      }
    },
    [gameState.energy, telegramId],
  )

  const openCase = useCallback(
    async (caseItem: CaseItem) => {
      if (gameState.magnumCoins < caseItem.price || !telegramId) return

      setOpeningCase(true)
      setSelectedCase(caseItem)

      try {
        const response = await fetch('/api/cases/open', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ 
            telegramId, 
            caseType: caseItem.id 
          }),
        })

        const data = await response.json()

        if (data.success) {
          setGameState((prev) => ({
            ...prev,
            magnumCoins: data.user.magnumCoins,
            stars: data.user.stars,
            energy: data.user.energy,
          }))

          setCaseResult(data.rewards)
        } else {
          console.error('Error opening case:', data.error)
        }
      } catch (error) {
        console.error('Error opening case:', error)
      } finally {
        setOpeningCase(false)
      }
    },
    [gameState.magnumCoins, telegramId],
  )

  const formatNumber = (num: number) => {
    if (num >= 1000000) return (num / 1000000).toFixed(2) + "M"
    if (num >= 1000) return (num / 1000).toFixed(2) + "K"
    return num.toFixed(num < 1 ? 4 : 0)
  }

  const getRarityColor = (rarity: string) => {
    switch (rarity) {
      case "common":
        return "text-gray-400"
      case "rare":
        return "text-blue-400"
      case "epic":
        return "text-purple-400"
      case "legendary":
        return "text-yellow-400"
      case "mythic":
        return "text-pink-400"
      default:
        return "text-gray-400"
    }
  }

  if (loading) {
    return (
      <div className="min-h-screen gradient-bg flex items-center justify-center">
        <div className="text-center">
          <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-accent mx-auto mb-4"></div>
          <p className="text-foreground">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>
      </div>
    )
  }

  const renderHomeScreen = () => (
    <div className="flex-1 flex flex-col p-6 space-y-6 relative">
      {/* Profile Button */}
      <div className="absolute top-4 right-4 z-10">
        <Button
          variant="ghost"
          size="sm"
          className="w-10 h-10 rounded-full bg-card/50 backdrop-blur-md border border-border/50 hover:bg-accent/20"
        >
          <User className="w-5 h-5 text-foreground" />
        </Button>
      </div>

      {/* Energy Bar */}
      <Card className="card-gradient p-4">
        <div className="flex items-center justify-between mb-2">
          <div className="flex items-center space-x-2">
            <Zap className={`w-5 h-5 text-energy ${gameState.energyAnimating ? "energy-drain" : ""}`} />
            <span className="text-sm font-medium text-foreground">–≠–Ω–µ—Ä–≥–∏—è</span>
          </div>
          <span className="text-sm font-bold text-energy">
            {gameState.energy}/{gameState.maxEnergy}
          </span>
        </div>
        <Progress value={(gameState.energy / gameState.maxEnergy) * 100} className="h-2 bg-muted" />
        <p className="text-xs text-muted-foreground mt-1">–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è: 1 —ç–Ω–µ—Ä–≥–∏—è / 30 —Å–µ–∫</p>
      </Card>

      {/* Balance Cards */}
      <div className="grid grid-cols-2 gap-4">
        <Card className="card-gradient p-4 text-center">
          <div className="flex items-center justify-center space-x-2 mb-2">
            <Coins className="w-5 h-5 text-accent" />
            <h3 className="text-sm font-bold text-foreground">Magnum</h3>
          </div>
          <p className="text-xl font-bold text-accent">{formatNumber(gameState.magnumCoins)}</p>
        </Card>

        <Card className="card-gradient p-4 text-center">
          <div className="flex items-center justify-center space-x-2 mb-2">
            <Star className="w-5 h-5 text-yellow-400" />
            <h3 className="text-sm font-bold text-foreground">Stars</h3>
          </div>
          <p className="text-xl font-bold text-yellow-400">{formatNumber(gameState.stars)}</p>
        </Card>
      </div>

      {/* Clicker Button */}
      <div className="flex-1 flex items-center justify-center">
        <div className="relative">
          <Button
            onClick={handleClick}
            disabled={gameState.energy <= 0}
            className={`w-40 h-40 rounded-full bg-gradient-to-br from-primary via-accent to-primary hover:from-accent hover:to-primary transition-all duration-300 pulse-glow disabled:opacity-50 disabled:cursor-not-allowed ${
              gameState.clickAnimating ? "coin-bounce" : ""
            }`}
            size="lg"
          >
            <div className="flex flex-col items-center space-y-2">
              <Coins className="w-12 h-12 text-primary-foreground" />
              <span className="text-sm font-bold text-primary-foreground">
                {gameState.energy > 0 ? "–ö–õ–ò–ö" : "–ù–ï–¢ –≠–ù–ï–†–ì–ò–ò"}
              </span>
            </div>
          </Button>

          {/* Reward Popups */}
          {gameState.rewardPopups.map((popup) => (
            <div
              key={popup.id}
              className="absolute pointer-events-none reward-popup text-accent font-bold text-base z-10"
              style={{ left: popup.x, top: popup.y }}
            >
              +1 ü™ô +0.0001 ‚≠ê
            </div>
          ))}
        </div>
      </div>

      {/* Stats */}
      <Card className="card-gradient p-4">
        <div className="grid grid-cols-3 gap-4 text-center">
          <div>
            <p className="text-muted-foreground text-xs">–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤</p>
            <p className="text-lg font-bold text-foreground">{formatNumber(gameState.totalClicks)}</p>
          </div>
          <div>
            <p className="text-muted-foreground text-xs">–°–∏–ª–∞ –∫–ª–∏–∫–∞</p>
            <p className="text-lg font-bold text-accent">1.0001</p>
          </div>
          <div>
            <p className="text-muted-foreground text-xs">–£—Ä–æ–≤–µ–Ω—å</p>
            <p className="text-lg font-bold text-primary">{gameState.level}</p>
          </div>
        </div>
      </Card>
    </div>
  )

  const renderCasesScreen = () => (
    <div className="flex-1 p-4 space-y-6">
      <div className="text-center space-y-2">
        <h1 className="text-2xl font-bold text-foreground flex items-center justify-center space-x-2">
          <Package className="w-6 h-6 text-primary" />
          <span>–ú–∞–≥–∞–∑–∏–Ω –∫–µ–π—Å–æ–≤</span>
        </h1>
        <p className="text-sm text-muted-foreground">–û—Ç–∫—Ä–æ–π—Ç–µ –∫–µ–π—Å—ã –∏ –ø–æ–ª—É—á–∏—Ç–µ –Ω–∞–≥—Ä–∞–¥—ã!</p>
      </div>

      {/* Balance Display */}
      <Card className="card-gradient p-4">
        <div className="flex items-center justify-between">
          <div className="flex items-center space-x-2">
            <Coins className="w-5 h-5 text-accent" />
            <span className="text-sm font-medium text-foreground">–í–∞—à –±–∞–ª–∞–Ω—Å:</span>
          </div>
          <span className="text-lg font-bold text-accent">{formatNumber(gameState.magnumCoins)} MC</span>
        </div>
      </Card>

      {/* Cases Grid */}
      <div className="space-y-4">
        {cases.map((caseItem, index) => (
          <Card
            key={caseItem.id}
            className={`case-card p-4 cursor-pointer transition-all duration-300 hover:scale-105 ${
              caseItem.rarity === "legendary" || caseItem.rarity === "mythic" ? "case-glow" : ""
            }`}
            onClick={() => openCase(caseItem)}
          >
            <div className="flex items-center space-x-4">
              {/* Case Image */}
              <div className="w-16 h-16 rounded-lg bg-gradient-to-br from-primary/20 to-accent/20 flex items-center justify-center text-3xl border border-border/50">
                {caseItem.image}
              </div>

              {/* Case Info */}
              <div className="flex-1">
                <div className="flex items-center space-x-2 mb-1">
                  <h3 className="font-bold text-foreground">{caseItem.name}</h3>
                  <span className={`text-xs px-2 py-1 rounded-full bg-muted/20 ${getRarityColor(caseItem.rarity)}`}>
                    {caseItem.rarity.toUpperCase()}
                  </span>
                </div>

                <div className="space-y-1">
                  <p className="text-xs text-muted-foreground">–í–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã:</p>
                  <div className="flex flex-wrap gap-1">
                    {caseItem.rewards.map((reward, idx) => (
                      <span key={idx} className="text-xs px-2 py-1 rounded bg-accent/10 text-accent">
                        {reward.type === "coins" && "ü™ô"}
                        {reward.type === "stars" && "‚≠ê"}
                        {reward.type === "energy" && "‚ö°"}
                        {reward.min}-{reward.max}
                      </span>
                    ))}
                  </div>
                </div>
              </div>

              {/* Price and Button */}
              <div className="text-right space-y-2">
                <div className="text-lg font-bold text-accent">{caseItem.price} MC</div>
                <Button
                  size="sm"
                  disabled={gameState.magnumCoins < caseItem.price}
                  className="bg-gradient-to-r from-primary to-accent hover:from-accent hover:to-primary"
                >
                  {gameState.magnumCoins >= caseItem.price ? "–û—Ç–∫—Ä—ã—Ç—å" : "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ"}
                </Button>
              </div>
            </div>

            {/* Rarity Indicator */}
            <div
              className="mt-3 h-1 rounded-full bg-gradient-to-r from-transparent via-current to-transparent opacity-30"
              style={{ color: caseItem.glowColor.replace("0.5", "1") }}
            />
          </Card>
        ))}
      </div>

      {/* Case Opening Modal */}
      {openingCase && selectedCase && (
        <div className="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50">
          <Card className="card-gradient p-8 text-center space-y-6 max-w-sm mx-4">
            <div className="text-6xl animate-spin">{selectedCase.image}</div>
            <h2 className="text-xl font-bold text-foreground">–û—Ç–∫—Ä—ã–≤–∞–µ–º {selectedCase.name}...</h2>
            <div className="w-full bg-muted rounded-full h-2">
              <div
                className="bg-gradient-to-r from-primary to-accent h-2 rounded-full animate-pulse"
                style={{ width: "100%" }}
              />
            </div>
          </Card>
        </div>
      )}

      {/* Case Result Modal */}
      {caseResult && (
        <div className="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50">
          <Card className="card-gradient p-8 text-center space-y-6 max-w-sm mx-4">
            <div className="text-4xl">üéâ</div>
            <h2 className="text-xl font-bold text-foreground">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
            <div className="space-y-2">
              {caseResult.map((reward: any, idx: number) => (
                <div key={idx} className="flex items-center justify-between p-2 rounded bg-accent/10">
                  <span className="text-foreground">
                    {reward.type === "coins" && "ü™ô –ú–æ–Ω–µ—Ç—ã"}
                    {reward.type === "stars" && "‚≠ê –ó–≤–µ–∑–¥—ã"}
                    {reward.type === "energy" && "‚ö° –≠–Ω–µ—Ä–≥–∏—è"}
                  </span>
                  <span className="font-bold text-accent">+{formatNumber(reward.amount)}</span>
                </div>
              ))}
            </div>
            <Button onClick={() => setCaseResult(null)} className="w-full">
              –ó–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—ã
            </Button>
          </Card>
        </div>
      )}
    </div>
  )

  const renderEventsScreen = () => (
    <div className="flex-1 flex items-center justify-center p-6 coming-soon-bg">
      <Card className="coming-soon-card p-8 text-center space-y-6 max-w-md mx-auto coming-soon-float">
        <div className="text-6xl mb-4">üéØ</div>
        <h1 className="text-3xl font-bold text-foreground">–°–æ–±—ã—Ç–∏—è</h1>
        <p className="text-muted-foreground">–ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è –∏ —Ç—É—Ä–Ω–∏—Ä—ã —É–∂–µ —Å–∫–æ—Ä–æ! –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏.</p>

        <div className="space-y-4">
          <div className="flex items-center space-x-3 p-3 rounded-lg bg-accent/10">
            <Trophy className="w-6 h-6 text-yellow-400" />
            <div className="text-left">
              <div className="font-medium text-foreground">–¢—É—Ä–Ω–∏—Ä—ã –∫–ª–∏–∫–µ—Ä–æ–≤</div>
              <div className="text-xs text-muted-foreground">–°–æ—Ä–µ–≤–Ω—É–π—Ç–µ—Å—å —Å –¥—Ä—É–≥–∏–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏</div>
            </div>
          </div>

          <div className="flex items-center space-x-3 p-3 rounded-lg bg-primary/10">
            <Target className="w-6 h-6 text-primary" />
            <div className="text-left">
              <div className="font-medium text-foreground">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</div>
              <div className="text-xs text-muted-foreground">–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è –∑–∞ –Ω–∞–≥—Ä–∞–¥—ã</div>
            </div>
          </div>

          <div className="flex items-center space-x-3 p-3 rounded-lg bg-purple-500/10">
            <Clock className="w-6 h-6 text-purple-400" />
            <div className="text-left">
              <div className="font-medium text-foreground">–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</div>
              <div className="text-xs text-muted-foreground">–û—Å–æ–±—ã–µ –±–æ–Ω—É—Å—ã –∏ –Ω–∞–≥—Ä–∞–¥—ã</div>
            </div>
          </div>
        </div>

        <Button className="w-full bg-gradient-to-r from-primary to-accent">–£–≤–µ–¥–æ–º–∏—Ç—å –æ –∑–∞–ø—É—Å–∫–µ</Button>
      </Card>
    </div>
  )

  const renderWalletScreen = () => (
    <div className="flex-1 flex items-center justify-center p-6 coming-soon-bg">
      <Card className="coming-soon-card p-8 text-center space-y-6 max-w-md mx-auto coming-soon-float">
        <div className="text-6xl mb-4">üí≥</div>
        <h1 className="text-3xl font-bold text-foreground">–ö–æ—à–µ–ª–µ–∫</h1>
        <p className="text-muted-foreground">–°–∏—Å—Ç–µ–º–∞ –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤ –∏ –æ–±–º–µ–Ω–∞ –≤–∞–ª—é—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.</p>

        <div className="space-y-4">
          <div className="flex items-center space-x-3 p-3 rounded-lg bg-accent/10">
            <Coins className="w-6 h-6 text-accent" />
            <div className="text-left">
              <div className="font-medium text-foreground">–û–±–º–µ–Ω –≤–∞–ª—é—Ç</div>
              <div className="text-xs text-muted-foreground">MC ‚Üî Stars ‚Üî TON</div>
            </div>
          </div>

          <div className="flex items-center space-x-3 p-3 rounded-lg bg-primary/10">
            <TrendingUp className="w-6 h-6 text-primary" />
            <div className="text-left">
              <div className="font-medium text-foreground">–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</div>
              <div className="text-xs text-muted-foreground">–ù–∞ –≤–Ω–µ—à–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∏</div>
            </div>
          </div>

          <div className="flex items-center space-x-3 p-3 rounded-lg bg-yellow-500/10">
            <Star className="w-6 h-6 text-yellow-400" />
            <div className="text-left">
              <div className="font-medium text-foreground">–°—Ç–µ–π–∫–∏–Ω–≥</div>
              <div className="text-xs text-muted-foreground">–ó–∞–º–æ—Ä–æ–∑—å—Ç–µ —Ç–æ–∫–µ–Ω—ã –∑–∞ –ø—Ä–æ—Ü–µ–Ω—Ç—ã</div>
            </div>
          </div>
        </div>

        <div className="p-4 rounded-lg bg-muted/10 border border-border/50">
          <div className="text-sm text-muted-foreground mb-2">–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å:</div>
          <div className="space-y-1">
            <div className="flex justify-between">
              <span className="text-foreground">Magnum Coins:</span>
              <span className="font-bold text-accent">{formatNumber(gameState.magnumCoins)}</span>
            </div>
            <div className="flex justify-between">
              <span className="text-foreground">Stars:</span>
              <span className="font-bold text-yellow-400">{formatNumber(gameState.stars)}</span>
            </div>
          </div>
        </div>

        <Button className="w-full bg-gradient-to-r from-primary to-accent">–£–≤–µ–¥–æ–º–∏—Ç—å –æ –∑–∞–ø—É—Å–∫–µ</Button>
      </Card>
    </div>
  )

  const renderContent = () => {
    switch (activeTab) {
      case "home":
        return renderHomeScreen()
      case "cases":
        return renderCasesScreen()
      case "events":
        return renderEventsScreen()
      case "wallet":
        return renderWalletScreen()
      default:
        return renderHomeScreen()
    }
  }

  return (
    <div className="min-h-screen gradient-bg flex flex-col relative">
      {/* Main Content */}
      {renderContent()}

      {/* Bottom Navigation */}
      <nav className="border-t border-border bg-card/50 backdrop-blur-md">
        <div className="grid grid-cols-4 gap-1">
          {[
            { id: "home", icon: Home, label: "–ì–ª–∞–≤–Ω–∞—è" },
            { id: "cases", icon: Package, label: "–ö–µ–π—Å—ã" },
            { id: "events", icon: Calendar, label: "–°–æ–±—ã—Ç–∏—è" },
            { id: "wallet", icon: Wallet, label: "–ö–æ—à–µ–ª–µ–∫" },
          ].map((tab) => (
            <Button
              key={tab.id}
              variant="ghost"
              className={`flex flex-col items-center space-y-1 p-3 h-auto transition-all duration-200 ${
                activeTab === tab.id
                  ? "text-accent bg-accent/10 scale-105"
                  : "text-muted-foreground hover:text-foreground hover:bg-muted/10"
              }`}
              onClick={() => setActiveTab(tab.id)}
            >
              <tab.icon className="w-5 h-5" />
              <span className="text-xs font-medium">{tab.label}</span>
            </Button>
          ))}
        </div>
      </nav>
    </div>
  )
}
